@model Http.News.Domain.Contracts.Dtos.ItemDetailsDto
<!-- Star raiting -->
@*<link href="http://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">*@
<link rel="stylesheet" href="~/Content/font-awesome.min.css">
<link href="~/Content/css/star-rating.css" media="all" rel="stylesheet" type="text/css" />
<!--suppress JSUnresolvedLibraryURL -->
@*<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>*@
<script src="~/Scripts/jquery-3.3.1.min.js"></script>
<script src="~/Scripts/star-rating.js" type="text/javascript"></script>
<link rel="stylesheet" href="~/Content/jquery.thumbs.css">
<script src="~/Scripts/jquery.thumbs.js"></script>

<div class="jq-rating" data-like="@Model.TotalLikes" data-dislike="@Model.TotalDislikes"></div>
<hr>
<div class="container" id="MyRate">
    @using (Html.BeginForm("Details", "Home", FormMethod.Post, new { viewModel = Model, score = "$(#score).value" }))
    {
        <input type="text" class="rating-input" id="starRating" name="score" value="@Model.AverageRating" data-size="md" title="Total users rating:">
        <input type="hidden" name="ArticleID" value="@Model.Id" />
        <input type="hidden" name="CategoryID" value="@Model.CategoryId" />
        @Html.HiddenFor(model => model.CategoryId)
        @Html.HiddenFor(model => model.BigImageUrl)
        @Html.HiddenFor(model => model.Content)
        @Html.HiddenFor(model => model.MediumImageUrl)
        @Html.HiddenFor(model => model.NumOfView)
        @Html.HiddenFor(model => model.ShortDescription)
        @Html.HiddenFor(model => model.SmallImageUrl)
        @Html.HiddenFor(model => model.Title)
        @Html.HiddenFor(model => model.AverageRating)
        @Html.HiddenFor(model => model.CreatedBy)
        @Html.HiddenFor(model => model.CreatedDate)
        @Html.HiddenFor(model => model.Id)
        @Html.HiddenFor(model => model.ModifiedBy)
        @Html.HiddenFor(model => model.ModifiedDate)
        @Html.HiddenFor(model => model.Rating)
        @Html.HiddenFor(model => model.TotalRaters)
        <br>
    }
    @if (ViewBag.Message != null)
    {
        <script type="text/javascript">
            window.onload = function () {
                alert("@ViewBag.Message");
            };
        </script>
    }
    <hr>
</div>
<script type="text/javascript">
    $('#starRating').rating();

    //$('.js-rating-simple').thumbs();

    @if (!User.Identity.IsAuthenticated)
    {
        @(Html.Raw("$(\".rating\").rating({ readonly: true });"));
    }

    $('#starRating').on('rating:change', function (event, value, caption) {
        var posting = $.post("@Url.Action("SetRating")", { itemId: @Model.Id, ratingValue: value });
        posting.done(function (result) {
            console.log(result);
            if (result === "")
            {
                alert('You have already rated this article');
            }
            var elem = $('#starRating');
            //elem.value = result;
            //console.log(elem.rating('update', value));
            //$('#starRating').rating('update', value);
        });
    });

    $('.jq-rating').thumbs({
        onLike: function (value) {

            $('.jq-rating').find('.sprite-fa-thumbs-up-grey')
                .removeClass("sprite-fa-thumbs-up-grey")
                .toggleClass("sprite-fa-thumbs-up-green");
            var posting = $.post("@Url.Action("SetLike")", { itemId: @Model.Id, isLike: true });
            posting.done(function(result) {
                console.log(result);
                if (result === "") {
                    alert('You have already rated this article');
                }
                alert('Thank You For Voting.');
            });
        },
        onDislike: function (value) {

            $('.jq-rating').find('.sprite-fa-thumbs-down-grey')
                .removeClass("sprite-fa-thumbs-down-grey")
                .toggleClass("sprite-fa-thumbs-down-green");
            var posting = $.post("@Url.Action("SetLike")", { itemId: @Model.Id, isLike: false });
            posting.done(function(result) {
                console.log(result);
                if (result === "") {
                    alert('You have already rated this article');
                }
                alert('Im sorry.');
            });
        }
    });

</script>